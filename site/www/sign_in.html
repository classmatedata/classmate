<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>>كلاسمت ClassMate קלאסמיייט </title>
    <link rel="stylesheet" href="./css/colors.css">
    <link rel="stylesheet" href="./css/index.css">
    <link rel="stylesheet" href="./css/general.css">

</head>
<body>
    <div class="container">
    <header>
        <navbar class="up-menu" id="up-menu">             
            <nav  class="to-teacher-view"><a class="text_to-teacher-view small"></a></nav>      
            <span class="text_i_am_a_student to-teacher-view" selected></span>
            <span class="text_i_am_a_teacher to-student-view"></span>
            <nav class="to-student-view" class="selected"><a class="text_to-student-view small"></a></span></nav>
        </navbar>
        
        
        <ul class="lang-container" id="navList_LangMenu" >
            <li><a id="lang_he" class="lang_Hebrew selected">עברית</a></li>
            <li><a id="lang_en" class="lang_English">English</a></li>
            <li><a id="lang_ar" class="lang_Arab">ערבית</a></li>
            <li><a id="lang_ru" class="lang_Russian">Russian</a></li> 
            
        </ul>
       
        <div class="logo"><a href="index.html"><img src="./img/logo_smaller.png" alt=""></a></div>
        <form action="" name="data_config" hidden>
            <input id="role_type"  value="student">
            <input id="lang" value="he" >
            <button type="button" onclick="updateGUI();">update Gui</button>
        </form>
    </header>
    <main>
        <div class="demo">
            
          
            <picture>
                <source srcset="./img/req/sign_in_edu_mobile.JPG" media="(max-width: 600px)">
                <source srcset="./img/req/sign_in_edu_site.JPG">
                <img src="./img/req/sign_in_edu_site.JPG" alt="edu gov site sign in">
            </picture>
            <p>מימוש של טופס מקושר לרישום דרך משרד החינוך</p>
            <div class="user_input">
                <label for="user_id" class="text_username_id">קוד משתמש</label>
                <input type="text" id="user_id" name="user_id" list="user_id_list" oninput="validateUserID()">
                <datalist id="user_id_list"></datalist>
            </div>


            <button id="btn_next_page" disabled  onclick="location.href='./start_config.html'"  type="button">עבור למסך הבא</button>
            <button   onclick="location.href='./index.html'" type="button">עבור למסך הקודם</button>
        </div>

    </main>

</div>
<script src="index.js" ></script>
<script>
let users_json = {};
function load_user_list() {
    fetch('./database/users.json')
    .then((response) => response.json())
    .then((json) => update_demo_users_list(json));
}    
function update_demo_users_list(json) {
    users_json = json;
    let dataHTML="";
    for(let key of Object.keys(json))
    {
        dataHTML += `<option value="${key}">${json[key]["name"]}</option>`;
    }
    document.querySelector("#user_id_list").innerHTML = dataHTML;
    localStorage.setItem("users_data",JSON.stringify(users_json) );
    
}
load_user_list() ;
function validateUserID() {
    const typed_user_id = document.querySelector("#user_id").value;
    if(users_json[typed_user_id] !== undefined) {
        document.querySelector("#btn_next_page").removeAttribute("disabled");
        localStorage.setItem("user_id", typed_user_id);
        localStorage.setItem("user_data",JSON.stringify(users_json[typed_user_id]) );
    }
    else {
        document.querySelector("#btn_next_page").setAttribute("disabled",true);
    }
}
</script>
</body>
</html>